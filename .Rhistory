champ.padj           = 0.05,
champ.control        = FALSE,
champ.run.combat     = FALSE,
champ.run.dmp        = FALSE, ##If only one pheno var must = FALSE
champ.run.dmr        = FALSE, ##If only one pheno var must = FALSE
champ.run.block      = FALSE, ##If only one pheno var must = FALSE
champ.run.gsea       = FALSE, ##Requires dmp and dmr results
champ.run.epimod     = FALSE, ##If only one pheno var must = FALSE
epi.run.gistic       = TRUE,
save.seg             = TRUE,
olaps.split.field    = "Sample_ID",
estimate.recurrence  = TRUE,
ov.less.stringent.ra.setting = TRUE,
ov.pvalue            = 0.05,
ov.keep.extra.columns = TRUE,
simplify.reduce      = weightedmean,
create.dir           = TRUE,
compare.list.files   = FALSE,
compare.files.in     = compare.files.in,
compare.names        = compare.names,
compare.olaps.size   = 1 ##Overlap of one or more base pairs
##considered
)
devtools::load_all()
############################## debug custom ################################
##debug(methyl_master_compare)
debug(methyl_master_formatting_custom)
debug(methyl_master_olaps_and_visualize)
input.dir <-
"G:\\My Drive\\dartmouth\\salas_lab\\cnv\\kirc_cbio_3p_select"
output.dir <-
"G:\\My Drive\\dartmouth\\salas_lab\\cnv\\kirc_3p_custom_internal"
sample.sheet.path <-
"G:\\My Drive\\dartmouth\\salas_lab\\cnv\\Sample_Sheet_kirc_cbio_3p_tum_cont_small.csv"
methyl_master(input.dir            = input.dir,
output.dir           = output.dir,
sample.sheet.path    = sample.sheet.path,
r.lib.path           = .libPaths()[1],
file.sep             = "\\\\",
create.dir           = TRUE,
n.cores              = 1,
os.type              = "windows",
proj                 = "TCGA-BLCA",
visualize            = TRUE,
visualize.individual = FALSE, ##Only works for routine sesame
routine              = "custom",
genome.version       = "hg19",
reference            = "internal", ##"comparison" or 'internal"
reference.name       = NA, ##NA for median, "all" For epicopy use,
##see below notes
comparison           = c("tumor","normal"),
form.thresholds      = c(-0.2,0.2), ##NULL c(-0.3,0.3),
save.seg             = TRUE,
sesame.data.cache    = "EPIC",
sesame.data.normal   = 'EPIC.5.normal',
##sesame.hm450.mean.correct = FALSE,
##sesame.form.add.meta = c("Tumor"), ##NULL
hm450.workflow       = "B",
champ.padj           = 0.05,
champ.control        = FALSE,
champ.run.combat     = FALSE,
champ.run.dmp        = FALSE, ##If only one pheno var must = FALSE
champ.run.dmr        = FALSE, ##If only one pheno var must = FALSE
champ.run.block      = FALSE, ##If only one pheno var must = FALSE
champ.run.gsea       = FALSE, ##Requires dmp and dmr results
champ.run.epimod     = FALSE, ##If only one pheno var must = FALSE
epi.run.gistic       = TRUE,
olaps.split.field    = "Sample_ID",
overlap.density      = 0.1,
estimate.recurrence  = TRUE,
ov.less.stringent.ra.setting = TRUE,
ov.pvalue            = 0.05,
ov.keep.extra.columns = TRUE,
simplify.reduce      = weightedmean
)
custom.form.thresholds
ov.seg
methyl_master(input.dir            = input.dir,
output.dir           = output.dir,
sample.sheet.path    = sample.sheet.path,
r.lib.path           = .libPaths()[1],
file.sep             = "\\\\",
create.dir           = TRUE,
n.cores              = 1,
os.type              = "windows",
proj                 = "TCGA-BLCA",
visualize            = TRUE,
visualize.individual = FALSE, ##Only works for routine sesame
routine              = "custom",
genome.version       = "hg19",
reference            = "internal", ##"comparison" or 'internal"
reference.name       = NA, ##NA for median, "all" For epicopy use,
##see below notes
comparison           = c("tumor","normal"),
form.thresholds      = c(-0.2,0.2), ##NULL c(-0.3,0.3),
save.seg             = TRUE,
sesame.data.cache    = "EPIC",
sesame.data.normal   = 'EPIC.5.normal',
##sesame.hm450.mean.correct = FALSE,
##sesame.form.add.meta = c("Tumor"), ##NULL
hm450.workflow       = "B",
champ.padj           = 0.05,
champ.control        = FALSE,
champ.run.combat     = FALSE,
champ.run.dmp        = FALSE, ##If only one pheno var must = FALSE
champ.run.dmr        = FALSE, ##If only one pheno var must = FALSE
champ.run.block      = FALSE, ##If only one pheno var must = FALSE
champ.run.gsea       = FALSE, ##Requires dmp and dmr results
champ.run.epimod     = FALSE, ##If only one pheno var must = FALSE
epi.run.gistic       = TRUE,
olaps.split.field    = "Sample_ID",
overlap.density      = 0.1,
estimate.recurrence  = TRUE,
ov.less.stringent.ra.setting = TRUE,
ov.pvalue            = 0.05,
ov.keep.extra.columns = TRUE,
simplify.reduce      = weightedmean
)
seg$chrom
seg$chrom
methyl_master(input.dir            = input.dir,
output.dir           = output.dir,
sample.sheet.path    = sample.sheet.path,
r.lib.path           = .libPaths()[1],
file.sep             = "\\\\",
create.dir           = TRUE,
n.cores              = 1,
os.type              = "windows",
proj                 = "TCGA-BLCA",
visualize            = TRUE,
visualize.individual = FALSE, ##Only works for routine sesame
routine              = "custom",
genome.version       = "hg19",
reference            = "internal", ##"comparison" or 'internal"
reference.name       = NA, ##NA for median, "all" For epicopy use,
##see below notes
comparison           = c("tumor","normal"),
form.thresholds      = c(-0.2,0.2), ##NULL c(-0.3,0.3),
save.seg             = TRUE,
sesame.data.cache    = "EPIC",
sesame.data.normal   = 'EPIC.5.normal',
##sesame.hm450.mean.correct = FALSE,
##sesame.form.add.meta = c("Tumor"), ##NULL
hm450.workflow       = "B",
champ.padj           = 0.05,
champ.control        = FALSE,
champ.run.combat     = FALSE,
champ.run.dmp        = FALSE, ##If only one pheno var must = FALSE
champ.run.dmr        = FALSE, ##If only one pheno var must = FALSE
champ.run.block      = FALSE, ##If only one pheno var must = FALSE
champ.run.gsea       = FALSE, ##Requires dmp and dmr results
champ.run.epimod     = FALSE, ##If only one pheno var must = FALSE
epi.run.gistic       = TRUE,
olaps.split.field    = "Sample_ID",
overlap.density      = 0.1,
estimate.recurrence  = TRUE,
ov.less.stringent.ra.setting = TRUE,
ov.pvalue            = 0.05,
ov.keep.extra.columns = TRUE,
simplify.reduce      = weightedmean
)
View(custom_seg_treatment.df)
colnames(seg)
devtools::load_all()
############################## debug custom ################################
##debug(methyl_master_compare)
debug(methyl_master_formatting_custom)
debug(methyl_master_olaps_and_visualize)
input.dir <-
"G:\\My Drive\\dartmouth\\salas_lab\\cnv\\kirc_cbio_3p_select"
output.dir <-
"G:\\My Drive\\dartmouth\\salas_lab\\cnv\\kirc_3p_custom_internal"
sample.sheet.path <-
"G:\\My Drive\\dartmouth\\salas_lab\\cnv\\Sample_Sheet_kirc_cbio_3p_tum_cont_small.csv"
methyl_master(input.dir            = input.dir,
output.dir           = output.dir,
sample.sheet.path    = sample.sheet.path,
r.lib.path           = .libPaths()[1],
file.sep             = "\\\\",
create.dir           = TRUE,
n.cores              = 1,
os.type              = "windows",
proj                 = "TCGA-BLCA",
visualize            = TRUE,
visualize.individual = FALSE, ##Only works for routine sesame
routine              = "custom",
genome.version       = "hg19",
reference            = "internal", ##"comparison" or 'internal"
reference.name       = NA, ##NA for median, "all" For epicopy use,
##see below notes
comparison           = c("tumor","normal"),
form.thresholds      = c(-0.2,0.2), ##NULL c(-0.3,0.3),
save.seg             = TRUE,
sesame.data.cache    = "EPIC",
sesame.data.normal   = 'EPIC.5.normal',
##sesame.hm450.mean.correct = FALSE,
##sesame.form.add.meta = c("Tumor"), ##NULL
hm450.workflow       = "B",
champ.padj           = 0.05,
champ.control        = FALSE,
champ.run.combat     = FALSE,
champ.run.dmp        = FALSE, ##If only one pheno var must = FALSE
champ.run.dmr        = FALSE, ##If only one pheno var must = FALSE
champ.run.block      = FALSE, ##If only one pheno var must = FALSE
champ.run.gsea       = FALSE, ##Requires dmp and dmr results
champ.run.epimod     = FALSE, ##If only one pheno var must = FALSE
epi.run.gistic       = TRUE,
olaps.split.field    = "Sample_ID",
overlap.density      = 0.1,
estimate.recurrence  = TRUE,
ov.less.stringent.ra.setting = TRUE,
ov.pvalue            = 0.05,
ov.keep.extra.columns = TRUE,
simplify.reduce      = weightedmean
)
seg
devtools::load_all()
methyl_master(input.dir            = input.dir,
output.dir           = output.dir,
sample.sheet.path    = sample.sheet.path,
r.lib.path           = .libPaths()[1],
file.sep             = "\\\\",
create.dir           = TRUE,
n.cores              = 1,
os.type              = "windows",
proj                 = "TCGA-BLCA",
visualize            = TRUE,
visualize.individual = FALSE, ##Only works for routine sesame
routine              = "custom",
genome.version       = "hg19",
reference            = "internal", ##"comparison" or 'internal"
reference.name       = NA, ##NA for median, "all" For epicopy use,
##see below notes
comparison           = c("tumor","normal"),
form.thresholds      = c(-0.2,0.2), ##NULL c(-0.3,0.3),
save.seg             = TRUE,
sesame.data.cache    = "EPIC",
sesame.data.normal   = 'EPIC.5.normal',
##sesame.hm450.mean.correct = FALSE,
##sesame.form.add.meta = c("Tumor"), ##NULL
hm450.workflow       = "B",
champ.padj           = 0.05,
champ.control        = FALSE,
champ.run.combat     = FALSE,
champ.run.dmp        = FALSE, ##If only one pheno var must = FALSE
champ.run.dmr        = FALSE, ##If only one pheno var must = FALSE
champ.run.block      = FALSE, ##If only one pheno var must = FALSE
champ.run.gsea       = FALSE, ##Requires dmp and dmr results
champ.run.epimod     = FALSE, ##If only one pheno var must = FALSE
epi.run.gistic       = TRUE,
olaps.split.field    = "Sample_ID",
overlap.density      = 0.1,
estimate.recurrence  = TRUE,
ov.less.stringent.ra.setting = TRUE,
ov.pvalue            = 0.05,
ov.keep.extra.columns = TRUE,
simplify.reduce      = weightedmean
)
rm(list=ls())
input.dir <-
"G:\\My Drive\\dartmouth\\salas_lab\\cnv\\kirc_cbio_3p_select"
output.dir <-
"G:\\My Drive\\dartmouth\\salas_lab\\cnv\\kirc_3p_custom_internal_all"
sample.sheet.path <-
"G:\\My Drive\\dartmouth\\salas_lab\\cnv\\Sample_Sheet_kirc_cbio_3p_tum_cont.csv"
methyl_master(input.dir            = input.dir,
output.dir           = output.dir,
sample.sheet.path    = sample.sheet.path,
r.lib.path           = .libPaths()[1],
file.sep             = "\\\\",
create.dir           = TRUE,
n.cores              = 1,
os.type              = "windows",
proj                 = "TCGA-BLCA",
visualize            = TRUE,
visualize.individual = FALSE, ##Only works for routine sesame
routine              = "custom",
genome.version       = "hg19",
reference            = "internal", ##"comparison" or 'internal"
reference.name       = NA, ##NA for median, "all" For epicopy use,
##see below notes
comparison           = c("tumor","normal"),
form.thresholds      = c(-0.2,0.2), ##NULL c(-0.3,0.3),
save.seg             = TRUE,
sesame.data.cache    = "EPIC",
sesame.data.normal   = 'EPIC.5.normal',
##sesame.hm450.mean.correct = FALSE,
##sesame.form.add.meta = c("Tumor"), ##NULL
hm450.workflow       = "B",
champ.padj           = 0.05,
champ.control        = FALSE,
champ.run.combat     = FALSE,
champ.run.dmp        = FALSE, ##If only one pheno var must = FALSE
champ.run.dmr        = FALSE, ##If only one pheno var must = FALSE
champ.run.block      = FALSE, ##If only one pheno var must = FALSE
champ.run.gsea       = FALSE, ##Requires dmp and dmr results
champ.run.epimod     = FALSE, ##If only one pheno var must = FALSE
epi.run.gistic       = TRUE,
olaps.split.field    = "Sample_ID",
overlap.density      = 0.1,
estimate.recurrence  = TRUE,
ov.less.stringent.ra.setting = TRUE,
ov.pvalue            = 0.05,
ov.keep.extra.columns = TRUE,
simplify.reduce      = weightedmean
)
devtools::load_all()
input.dir <-
"G:\\My Drive\\dartmouth\\salas_lab\\cnv\\kirc_cbio_3p_select"
output.dir <-
"G:\\My Drive\\dartmouth\\salas_lab\\cnv\\kirc_3p_custom_internal_all"
sample.sheet.path <-
"G:\\My Drive\\dartmouth\\salas_lab\\cnv\\Sample_Sheet_kirc_cbio_3p_tum_cont.csv"
methyl_master(input.dir            = input.dir,
output.dir           = output.dir,
sample.sheet.path    = sample.sheet.path,
r.lib.path           = .libPaths()[1],
file.sep             = "\\\\",
create.dir           = TRUE,
n.cores              = 1,
os.type              = "windows",
proj                 = "TCGA-BLCA",
visualize            = TRUE,
visualize.individual = FALSE, ##Only works for routine sesame
routine              = "custom",
genome.version       = "hg19",
reference            = "internal", ##"comparison" or 'internal"
reference.name       = NA, ##NA for median, "all" For epicopy use,
##see below notes
comparison           = c("tumor","normal"),
form.thresholds      = c(-0.2,0.2), ##NULL c(-0.3,0.3),
save.seg             = TRUE,
sesame.data.cache    = "EPIC",
sesame.data.normal   = 'EPIC.5.normal',
##sesame.hm450.mean.correct = FALSE,
##sesame.form.add.meta = c("Tumor"), ##NULL
hm450.workflow       = "B",
champ.padj           = 0.05,
champ.control        = FALSE,
champ.run.combat     = FALSE,
champ.run.dmp        = FALSE, ##If only one pheno var must = FALSE
champ.run.dmr        = FALSE, ##If only one pheno var must = FALSE
champ.run.block      = FALSE, ##If only one pheno var must = FALSE
champ.run.gsea       = FALSE, ##Requires dmp and dmr results
champ.run.epimod     = FALSE, ##If only one pheno var must = FALSE
epi.run.gistic       = TRUE,
olaps.split.field    = "Sample_ID",
overlap.density      = 0.1,
estimate.recurrence  = TRUE,
ov.less.stringent.ra.setting = TRUE,
ov.pvalue            = 0.05,
ov.keep.extra.columns = TRUE,
simplify.reduce      = weightedmean
)
input.dir <-
"G:\\My Drive\\dartmouth\\salas_lab\\cnv\\kirc_cbio_3p_select"
output.dir <-
"G:\\My Drive\\dartmouth\\salas_lab\\cnv\\kirc_3p_champ_internal_all"
sample.sheet.path <-
"G:\\My Drive\\dartmouth\\salas_lab\\cnv\\Sample_Sheet_kirc_cbio_3p_tum_cont.csv"
methyl_master(input.dir            = input.dir,
output.dir           = output.dir,
sample.sheet.path    = sample.sheet.path,
r.lib.path           = .libPaths()[1],
file.sep             = "\\\\",
create.dir           = TRUE,
n.cores              = 1,
os.type              = "windows",
proj                 = "TCGA-BLCA",
visualize            = TRUE,
visualize.individual = FALSE, ##Only works for routine sesame
routine              = "champ",
genome.version       = "hg19",
reference            = "internal", ##"comparison" or 'internal"
reference.name       = NA, ##NA for median, "all" For epicopy use,
##see below notes
comparison           = c("tumor","normal"),
form.thresholds      = c(-0.2,0.2), ##NULL c(-0.3,0.3),
save.seg             = TRUE,
sesame.data.cache    = "EPIC",
sesame.data.normal   = 'EPIC.5.normal',
##sesame.hm450.mean.correct = FALSE,
##sesame.form.add.meta = c("Tumor"), ##NULL
hm450.workflow       = "B",
champ.padj           = 0.05,
champ.control        = FALSE,
champ.run.combat     = FALSE,
champ.run.dmp        = FALSE, ##If only one pheno var must = FALSE
champ.run.dmr        = FALSE, ##If only one pheno var must = FALSE
champ.run.block      = FALSE, ##If only one pheno var must = FALSE
champ.run.gsea       = FALSE, ##Requires dmp and dmr results
champ.run.epimod     = FALSE, ##If only one pheno var must = FALSE
epi.run.gistic       = TRUE,
olaps.split.field    = "Sample_ID",
overlap.density      = 0.1,
estimate.recurrence  = TRUE,
ov.less.stringent.ra.setting = TRUE,
ov.pvalue            = 0.05,
ov.keep.extra.columns = TRUE,
simplify.reduce      = weightedmean
)
methyl_master(input.dir            = input.dir,
output.dir           = output.dir,
sample.sheet.path    = sample.sheet.path,
r.lib.path           = .libPaths()[1],
file.sep             = "\\\\",
create.dir           = TRUE,
n.cores              = 1,
os.type              = "windows",
proj                 = "TCGA-BLCA",
visualize            = TRUE,
visualize.individual = FALSE, ##Only works for routine sesame
routine              = "champ",
genome.version       = "hg19",
reference            = "internal", ##"comparison" or 'internal"
reference.name       = NA, ##NA for median, "all" For epicopy use,
##see below notes
comparison           = c("tumor","normal"),
form.thresholds      = c(-0.2,0.2), ##NULL c(-0.3,0.3),
save.seg             = TRUE,
sesame.data.cache    = "EPIC",
sesame.data.normal   = 'EPIC.5.normal',
##sesame.hm450.mean.correct = FALSE,
##sesame.form.add.meta = c("Tumor"), ##NULL
hm450.workflow       = "B",
champ.padj           = 0.05,
champ.control        = FALSE,
champ.run.combat     = FALSE,
champ.run.dmp        = FALSE, ##If only one pheno var must = FALSE
champ.run.dmr        = FALSE, ##If only one pheno var must = FALSE
champ.run.block      = FALSE, ##If only one pheno var must = FALSE
champ.run.gsea       = FALSE, ##Requires dmp and dmr results
champ.run.epimod     = FALSE, ##If only one pheno var must = FALSE
epi.run.gistic       = TRUE,
olaps.split.field    = "Sample_ID",
overlap.density      = 0.1,
estimate.recurrence  = TRUE,
ov.less.stringent.ra.setting = TRUE,
ov.pvalue            = 0.05,
ov.keep.extra.columns = TRUE,
simplify.reduce      = weightedmean
)
devtools::load_all()
input.dir <-
"G:\\My Drive\\dartmouth\\salas_lab\\cnv\\kirc_cbio_3p_select"
output.dir <-
"G:\\My Drive\\dartmouth\\salas_lab\\cnv\\kirc_3p_champ_internal_all"
sample.sheet.path <-
"G:\\My Drive\\dartmouth\\salas_lab\\cnv\\Sample_Sheet_kirc_cbio_3p_tum_cont.csv"
methyl_master(input.dir            = input.dir,
output.dir           = output.dir,
sample.sheet.path    = sample.sheet.path,
r.lib.path           = .libPaths()[1],
file.sep             = "\\\\",
create.dir           = TRUE,
n.cores              = 1,
os.type              = "windows",
proj                 = "TCGA-BLCA",
visualize            = TRUE,
visualize.individual = FALSE, ##Only works for routine sesame
routine              = "champ",
genome.version       = "hg19",
reference            = "internal", ##"comparison" or 'internal"
reference.name       = NA, ##NA for median, "all" For epicopy use,
##see below notes
comparison           = c("tumor","normal"),
form.thresholds      = c(-0.2,0.2), ##NULL c(-0.3,0.3),
save.seg             = TRUE,
sesame.data.cache    = "EPIC",
sesame.data.normal   = 'EPIC.5.normal',
##sesame.hm450.mean.correct = FALSE,
##sesame.form.add.meta = c("Tumor"), ##NULL
hm450.workflow       = "B",
champ.padj           = 0.05,
champ.control        = FALSE,
champ.run.combat     = FALSE,
champ.run.dmp        = FALSE, ##If only one pheno var must = FALSE
champ.run.dmr        = FALSE, ##If only one pheno var must = FALSE
champ.run.block      = FALSE, ##If only one pheno var must = FALSE
champ.run.gsea       = FALSE, ##Requires dmp and dmr results
champ.run.epimod     = FALSE, ##If only one pheno var must = FALSE
epi.run.gistic       = TRUE,
olaps.split.field    = "Sample_ID",
overlap.density      = 0.1,
estimate.recurrence  = TRUE,
ov.less.stringent.ra.setting = TRUE,
ov.pvalue            = 0.05,
ov.keep.extra.columns = TRUE,
simplify.reduce      = weightedmean
)
library(sesame)
library(Seurat)
?Seurat::NormalizeData
library(GenomicRanges)
citation("GenomicRanges")
library(populationranges)
library(populationTanges)
library(populationRanges)
CNVRanger
library(CNVRanger)
populationRanges
citation(populationRanges)
citation("populationRanges")
citation("CNVRanger")
CNVRanger::populationRanges()
CNVRanger::populationRanges
citation("peakRAM")
citation("GenomicRanges")
library(conumee)
citation("conumee")
library(DNAcopy)
citation("DNAcopy")
